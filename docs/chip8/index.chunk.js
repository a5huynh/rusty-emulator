(window.webpackJsonp=window.webpackJsonp||[]).push([[1],[,function(t,e,n){"use strict";n.r(e);var r=n(4),i=n(2);n(5);const s=5,o="#FFFFFF",a="#000000";class h{constructor(t,e,n,r,i){this.canvas=document.getElementById(t),this.ctx=this.canvas.getContext("2d"),this.memory=e,this.displayPtr=n,this.width=r,this.height=i,this.canvas.height=s*this.height,this.canvas.width=s*this.width,this.pixels=new Uint8Array(this.memory.buffer,this.displayPtr,this.width*this.height),this.drawPixels=this.drawPixels.bind(this)}getIndex(t,e){return t*this.width+e}drawPixels(){this.ctx.beginPath(),this.ctx.fillStyle=a;for(let t=0;t<this.height;t++)for(let e=0;e<this.width;e++){const n=this.getIndex(t,e);0!==this.pixels[n]&&this.ctx.fillRect(e*s,t*s,s,s)}this.ctx.fillStyle=o;for(let t=0;t<this.height;t++)for(let e=0;e<this.width;e++){const n=this.getIndex(t,e);1!==this.pixels[n]&&this.ctx.fillRect(e*s,t*s,s,s)}this.ctx.stroke()}}class c{constructor(){this.fps=document.getElementById("fps"),this.frames=[],this.lastFrame=performance.now()}render(){const t=performance.now(),e=t-this.lastFrame;this.lastFrame=t;const n=1/e*1e3;this.frames.push(n),this.frames.length>100&&this.frames.shift();let r=1/0,i=-1/0,s=0;for(let t=0;t<this.frames.length;t++)s+=this.frames[t],r=Math.min(this.frames[t],r),i=Math.max(this.frames[t],i);let o=s/this.frames.length;this.fps.textContent=`fps: ${Math.round(n)} (${Math.round(o)})`}}const u=32;class l{constructor(t,e,n,r,i,s,o,a,h){this.memory=t,this.registers=new Uint8Array(this.memory.buffer,e,n),this.memoryPtr=r,this.memorySize=i,this.stackPtr=s,this.stackSize=o,this.pcPtr=a,this.spPtr=h,this._toHex=this._toHex.bind(this),this.drawMemory=this.drawMemory.bind(this),this.drawRegisters=this.drawRegisters.bind(this)}_toHex(t,e=2){const n=t.toString(16);return"0".repeat(e-n.length)+n}drawRegisters(){let t="";for(let e=0;e<this.registers.length-2;e++)t+=`<div>V${this._toHex(e)}: 0x${this._toHex(this.registers[e])}</div>`;document.getElementById("registers").innerHTML=t}drawMemory(t){const e=document.getElementById("memory");if(!t)return void(e.innerHTML="<code>Memory only shown on pause.</code>");const n=new Uint8Array(this.memory.buffer,this.memoryPtr,this.memorySize);let r="";for(let t=0;t<this.memorySize/u;t++){let e=t*u;r+=`<div>${this._toHex(e,3)}: `;for(let e=0;e<u;e++){let i=t*u+e;r+=`<span>${this._toHex(n[i])}</span>`}r+="</div>"}e.innerHTML=`<code>${r}</code>`}}const d=4,f={49:1,50:2,51:3,52:12,81:4,87:5,69:6,82:13,65:7,83:8,68:9,70:14,90:10,88:0,67:11,86:15};let p=new class{constructor(t){this.animationId=null,this.engine=i.a.new(),this.width=i.a.display_width(),this.height=i.a.display_height(),this.memory=t,this.display=new h("engine-display",this.memory,this.engine.display(),this.width,this.height),this.memDisplay=new l(this.memory,this.engine.registers(),i.a.num_registers(),this.engine.memory(),i.a.mem_size(),this.engine.stack(),i.a.stack_size(),this.engine.pc(),this.engine.sp()),this.fps=new c,this.handleKeyPress=this.handleKeyPress.bind(this),this.handleKeyUp=this.handleKeyUp.bind(this),this.isPaused=this.isPaused.bind(this),this.render=this.render.bind(this),this.tick=this.tick.bind(this),window.addEventListener("keydown",this.handleKeyPress),window.addEventListener("keyup",this.handleKeyUp)}_Base64toBytes(t){let e=atob(t),n=new Uint8Array(e.length);for(let t=0;t<e.length;t++)n[t]=e.charCodeAt(t);return n}_parseURLParams(){let t=new URLSearchParams(window.location.search);this.showMemDisplay=!!t.has("memDisplay")&&"true"===t.get("memDisplay")}handleKeyPress(t){t.keyCode in f&&this.engine.key_press(f[t.keyCode])}handleKeyUp(t){t.keyCode in f&&this.engine.key_up(f[t.keyCode])}isPaused(){return null===this.animationId}tick(){this.fps.render(),this.render();for(let t=0;t<d;t++)this.engine.tick();this.animationId=requestAnimationFrame(this.tick)}render(){this.display.drawPixels(),this.memDisplay.drawRegisters(),this.showMemDisplay&&this.memDisplay.drawMemory(this.isPaused())}}(r.t);const m=document.getElementById("rom-list");m.innerHTML+="<option>Select a ROM</option>",[{path:"Breakout [Carmelo Cortez, 1979].ch8",name:"Breakout"},{path:"Brix [Andreas Gustafsson, 1990].ch8",name:"Brix"},{path:"Chip8 emulator Logo [Garstyciuks].ch8",name:"Chip8 Logo"},{path:"Maze [David Winter, 199x].ch8",name:"Maze"},{path:"Particle Demo [zeroZshadow, 2008].ch8",name:"Particle Demo"},{path:"Pong (alt).ch8",name:"Pong"},{path:"Sierpinski [Sergey Naydenov, 2010].ch8",name:"Sierpinski"},{path:"Space Invaders [David Winter].ch8",name:"Space Invaders"},{path:"Tetris [Fran Dachille, 1991].ch8",name:"Tetris"},{path:"Zero Demo [zeroZshadow, 2007].ch8",name:"Zero Demo"}].forEach(t=>m.innerHTML+=`<option value="${t.path}">${t.name}</option>`),m.addEventListener("change",t=>{const e=t.target.value;return fetch(`roms/chip8/${e}`).then(t=>{if(!t.ok)throw new Error(t.statusText);return t.arrayBuffer()}).then(t=>{let e=new Uint8Array(t);p.engine.load_rom(e)})});const y=document.getElementById("play-pause");y.textContent="▶";y.addEventListener("click",t=>{p.isPaused()?(console.log("Starting engine"),y.textContent="⏸",p.tick()):(console.log("Pausing engine"),y.textContent="▶",cancelAnimationFrame(p.animationId),p.animationId=null,p.render())}),p.render()},function(t,e,n){"use strict";n.d(e,"b",function(){return c}),n.d(e,"c",function(){return l}),n.d(e,"a",function(){return d}),n.d(e,"d",function(){return f});var r=n(4);const i=console.log;let s=new TextDecoder("utf-8"),o=null;function a(){return null!==o&&o.buffer===r.t.buffer||(o=new Uint8Array(r.t.buffer)),o}function h(t,e){return s.decode(a().subarray(t,t+e))}function c(t,e){let n=h(t,e);i(n)}Object.freeze({K1:0,K2:1,K3:2,K4:3,K5:4,K6:5,K7:6,K8:7,K9:8,K0:9,KA:10,KB:11,KC:12,KD:13,KE:14,KF:15}),Object.freeze({V0:0,V1:1,V2:2,V3:3,V4:4,V5:5,V6:6,V7:7,V8:8,V9:9,VA:10,VB:11,VC:12,VD:13,VE:14,VF:15,DT:16,ST:17});const u=Math.random.bind(Math)||function(){throw new Error("wasm-bindgen: Math.random.bind(Math) does not exist")};function l(){return u()}class d{static __construct(t){return new d(t)}constructor(t){this.ptr=t}free(){const t=this.ptr;this.ptr=0,function(t){r.a(t)}(t)}static new(){return d.__construct(r.k())}static display_height(){return r.d()}static display_width(){return r.e()}static mem_size(){return r.i()}static num_registers(){return r.l()}static stack_size(){return r.r()}display(){if(0===this.ptr)throw new Error("Attempt to use a moved value");return r.c(this.ptr)}registers(){if(0===this.ptr)throw new Error("Attempt to use a moved value");return r.n(this.ptr)}memory(){if(0===this.ptr)throw new Error("Attempt to use a moved value");return r.j(this.ptr)}stack(){if(0===this.ptr)throw new Error("Attempt to use a moved value");return r.q(this.ptr)}pc(){if(0===this.ptr)throw new Error("Attempt to use a moved value");return r.m(this.ptr)}sp(){if(0===this.ptr)throw new Error("Attempt to use a moved value");return r.p(this.ptr)}key_press(t){if(0===this.ptr)throw new Error("Attempt to use a moved value");return r.f(this.ptr,t)}key_up(t){if(0===this.ptr)throw new Error("Attempt to use a moved value");return r.g(this.ptr,t)}load_rom(t){if(0===this.ptr)throw new Error("Attempt to use a moved value");const[e,n]=function(t){return void 0===t||null===t}(t)?[0,0]:function(t){const e=r.b(1*t.length);return a().set(t,e/1),[e,t.length]}(t);return r.h(this.ptr,e,n)}reset(){if(0===this.ptr)throw new Error("Attempt to use a moved value");return r.o(this.ptr)}tick(){if(0===this.ptr)throw new Error("Attempt to use a moved value");return r.s(this.ptr)}}function f(t,e){throw new Error(h(t,e))}},function(t,e,n){(t.exports=n(6)(!1)).push([t.i,"body {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  display: flex;\n  flex-direction: row;\n  align-items: top;\n  justify-content: center; }\n\ncode {\n  font-size: 10px; }\n\ntable td {\n  padding: 0 16px;\n  text-align: center; }\n  table td .sidebar {\n    width: 100px; }\n  table td .topbar {\n    width: 100%;\n    text-align: center; }\n\ncanvas {\n  border: 1px solid #EEE; }\n\n#memory {\n  height: 512px;\n  overflow-y: scroll; }\n\n#memory div > span {\n  margin-right: 4px; }\n",""])},function(t,e,n){"use strict";var r=n.w[t.i];t.exports=r;n(2);r.u()},function(t,e,n){var r=n(3);"string"==typeof r&&(r=[[t.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0},s=n(7)(r,i);r.locals&&(t.exports=r.locals),t.hot.accept(3,function(){var e=n(3);if("string"==typeof e&&(e=[[t.i,e,""]]),!function(t,e){var n,r=0;for(n in t){if(!e||t[n]!==e[n])return!1;r++}for(n in e)r--;return 0===r}(r.locals,e.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");s(e)}),t.hot.dispose(function(){s()})},function(t,e){t.exports=function(t){var e=[];return e.toString=function(){return this.map(function(e){var n=function(t,e){var n=t[1]||"",r=t[3];if(!r)return n;if(e&&"function"==typeof btoa){var i=function(t){return"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(t))))+" */"}(r),s=r.sources.map(function(t){return"/*# sourceURL="+r.sourceRoot+t+" */"});return[n].concat(s).concat([i]).join("\n")}return[n].join("\n")}(e,t);return e[2]?"@media "+e[2]+"{"+n+"}":n}).join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var r={},i=0;i<this.length;i++){var s=this[i][0];"number"==typeof s&&(r[s]=!0)}for(i=0;i<t.length;i++){var o=t[i];"number"==typeof o[0]&&r[o[0]]||(n&&!o[2]?o[2]=n:n&&(o[2]="("+o[2]+") and ("+n+")"),e.push(o))}},e}},function(t,e,n){var r={},i=function(t){var e;return function(){return void 0===e&&(e=t.apply(this,arguments)),e}}(function(){return window&&document&&document.all&&!window.atob}),s=function(t){var e={};return function(t,n){if("function"==typeof t)return t();if(void 0===e[t]){var r=function(t,e){return e?e.querySelector(t):document.querySelector(t)}.call(this,t,n);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(t){r=null}e[t]=r}return e[t]}}(),o=null,a=0,h=[],c=n(8);function u(t,e){for(var n=0;n<t.length;n++){var i=t[n],s=r[i.id];if(s){s.refs++;for(var o=0;o<s.parts.length;o++)s.parts[o](i.parts[o]);for(;o<i.parts.length;o++)s.parts.push(y(i.parts[o],e))}else{var a=[];for(o=0;o<i.parts.length;o++)a.push(y(i.parts[o],e));r[i.id]={id:i.id,refs:1,parts:a}}}}function l(t,e){for(var n=[],r={},i=0;i<t.length;i++){var s=t[i],o=e.base?s[0]+e.base:s[0],a={css:s[1],media:s[2],sourceMap:s[3]};r[o]?r[o].parts.push(a):n.push(r[o]={id:o,parts:[a]})}return n}function d(t,e){var n=s(t.insertInto);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var r=h[h.length-1];if("top"===t.insertAt)r?r.nextSibling?n.insertBefore(e,r.nextSibling):n.appendChild(e):n.insertBefore(e,n.firstChild),h.push(e);else if("bottom"===t.insertAt)n.appendChild(e);else{if("object"!=typeof t.insertAt||!t.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var i=s(t.insertAt.before,n);n.insertBefore(e,i)}}function f(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t);var e=h.indexOf(t);e>=0&&h.splice(e,1)}function p(t){var e=document.createElement("style");if(void 0===t.attrs.type&&(t.attrs.type="text/css"),void 0===t.attrs.nonce){var r=function(){0;return n.nc}();r&&(t.attrs.nonce=r)}return m(e,t.attrs),d(t,e),e}function m(t,e){Object.keys(e).forEach(function(n){t.setAttribute(n,e[n])})}function y(t,e){var n,r,i,s;if(e.transform&&t.css){if(!(s="function"==typeof e.transform?e.transform(t.css):e.transform.default(t.css)))return function(){};t.css=s}if(e.singleton){var h=a++;n=o||(o=p(e)),r=v.bind(null,n,h,!1),i=v.bind(null,n,h,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=function(t){var e=document.createElement("link");return void 0===t.attrs.type&&(t.attrs.type="text/css"),t.attrs.rel="stylesheet",m(e,t.attrs),d(t,e),e}(e),r=function(t,e,n){var r=n.css,i=n.sourceMap,s=void 0===e.convertToAbsoluteUrls&&i;(e.convertToAbsoluteUrls||s)&&(r=c(r));i&&(r+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+" */");var o=new Blob([r],{type:"text/css"}),a=t.href;t.href=URL.createObjectURL(o),a&&URL.revokeObjectURL(a)}.bind(null,n,e),i=function(){f(n),n.href&&URL.revokeObjectURL(n.href)}):(n=p(e),r=function(t,e){var n=e.css,r=e.media;r&&t.setAttribute("media",r);if(t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}.bind(null,n),i=function(){f(n)});return r(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;r(t=e)}else i()}}t.exports=function(t,e){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(e=e||{}).attrs="object"==typeof e.attrs?e.attrs:{},e.singleton||"boolean"==typeof e.singleton||(e.singleton=i()),e.insertInto||(e.insertInto="head"),e.insertAt||(e.insertAt="bottom");var n=l(t,e);return u(n,e),function(t){for(var i=[],s=0;s<n.length;s++){var o=n[s];(a=r[o.id]).refs--,i.push(a)}t&&u(l(t,e),e);for(s=0;s<i.length;s++){var a;if(0===(a=i[s]).refs){for(var h=0;h<a.parts.length;h++)a.parts[h]();delete r[a.id]}}}};var w=function(){var t=[];return function(e,n){return t[e]=n,t.filter(Boolean).join("\n")}}();function v(t,e,n,r){var i=n?"":r.css;if(t.styleSheet)t.styleSheet.cssText=w(e,i);else{var s=document.createTextNode(i),o=t.childNodes;o[e]&&t.removeChild(o[e]),o.length?t.insertBefore(s,o[e]):t.appendChild(s)}}},function(t,e){t.exports=function(t){var e="undefined"!=typeof window&&window.location;if(!e)throw new Error("fixUrls requires window.location");if(!t||"string"!=typeof t)return t;var n=e.protocol+"//"+e.host,r=n+e.pathname.replace(/\/[^\/]*$/,"/");return t.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(t,e){var i,s=e.trim().replace(/^"(.*)"$/,function(t,e){return e}).replace(/^'(.*)'$/,function(t,e){return e});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(s)?t:(i=0===s.indexOf("//")?s:0===s.indexOf("/")?n+s:r+s.replace(/^\.\//,""),"url("+JSON.stringify(i)+")")})}}]]);
//# sourceMappingURL=index.chunk.js.map