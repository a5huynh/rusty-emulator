{"version":3,"sources":["webpack:///./src/lib/ui/display.ts","webpack:///./src/lib/ui/fps.ts","webpack:///./src/lib/ui/memory.ts","webpack:///./src/lib/engine.ts","webpack:///./src/index.js","webpack:///../pkg/z80_emulator.js","webpack:///./src/lib/ui/display.scss","webpack:///./src/lib/ui/display.scss?a932","webpack:///./node_modules/css-loader/lib/css-base.js","webpack:///./node_modules/style-loader/lib/addStyles.js","webpack:///./node_modules/style-loader/lib/urls.js"],"names":["CELL_SIZE","OFF_COLOR","ON_COLOR","Display","[object Object]","elementId","memory","displayPtr","width","height","this","canvas","document","getElementById","ctx","getContext","pixels","Uint8Array","buffer","drawPixels","bind","row","col","beginPath","fillStyle","idx","getIndex","fillRect","stroke","FPS","fps","frames","lastFrame","performance","now","delta","push","length","shift","min","Infinity","max","sum","i","Math","mean","textContent","round","MEM_PER_ROW","MemoryDisplay","registersPtr","numRegisters","memoryPtr","memorySize","stackPtr","stackSize","pcPtr","spPtr","registers","_toHex","drawMemory","drawRegisters","number","len","hex","toString","repeat","disp","innerHTML","isPaused","element","rowStart","SPEED_UP","KEY_MAP","49","50","51","52","81","87","69","82","65","83","68","70","90","88","67","86","engine","animationId","z80_emulator","new","display_width","display_height","display","memDisplay","num_registers","mem_size","stack","stack_size","pc","sp","handleKeyPress","handleKeyUp","render","tick","window","addEventListener","data","decoded","atob","array","charCodeAt","urlParams","URLSearchParams","location","search","showMemDisplay","has","get","ev","keyCode","key_press","key_up","requestAnimationFrame","z80_emulator_bg","romList","path","name","forEach","rom","event","target","value","fetch","then","resp","ok","Error","statusText","arrayBuffer","load_rom","playPauseButton","console","log","cancelAnimationFrame","__webpack_require__","d","__webpack_exports__","__wbg_log_c91f5c35c829c418","__wbg_random_86efc8986c8a8805","CHIP8","__wbindgen_throw","_z80_emulator_bg__WEBPACK_IMPORTED_MODULE_0__","__wbg_log_c91f5c35c829c418_target","cachedDecoder","TextDecoder","cachegetUint8Memory","getUint8Memory","getStringFromWasm","ptr","decode","subarray","arg0","arg1","varg0","Object","freeze","K1","K2","K3","K4","K5","K6","K7","K8","K9","K0","KA","KB","KC","KD","KE","KF","V0","V1","V2","V3","V4","V5","V6","V7","V8","V9","VA","VB","VC","VD","VE","VF","DT","ST","__wbg_random_86efc8986c8a8805_target","random","freeCHIP8","__construct","ptr0","len0","x","undefined","isLikeNone","arg","set","passArray8ToWasm","module","exports","content","options","hmr","transform","insertInto","update","locals","hot","accept","newContent","a","b","key","dispose","useSourceMap","list","map","item","cssMapping","btoa","sourceMapping","sourceMap","unescape","encodeURIComponent","JSON","stringify","toComment","sourceURLs","sources","source","sourceRoot","concat","join","cssWithMappingToString","modules","mediaQuery","alreadyImportedModules","id","stylesInDom","isOldIE","fn","memo","apply","arguments","memoize","all","getElement","parent","styleTarget","querySelector","call","HTMLIFrameElement","contentDocument","head","e","singleton","singletonCounter","stylesInsertedAtTop","fixUrls","addStylesToDom","styles","domStyle","refs","j","parts","addStyle","listToStyles","newStyles","base","part","css","media","insertStyleElement","style","lastStyleElementInsertedAtTop","insertAt","nextSibling","insertBefore","appendChild","firstChild","before","removeStyleElement","parentNode","removeChild","indexOf","splice","createStyleElement","createElement","attrs","type","nonce","nc","getNonce","addAttrs","el","keys","setAttribute","obj","remove","result","default","styleIndex","applyToSingletonTag","URL","createObjectURL","revokeObjectURL","Blob","link","rel","createLinkElement","autoFixUrls","convertToAbsoluteUrls","blob","oldSrc","href","styleSheet","cssText","createTextNode","newObj","DEBUG","newList","mayRemove","replaceText","textStore","index","replacement","filter","Boolean","cssNode","childNodes","baseUrl","protocol","host","currentDir","pathname","replace","fullMatch","origUrl","newUrl","unquotedOrigUrl","trim","o","$1","test"],"mappings":"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","file":"index.chunk.js","sourcesContent":["import { WasmMemory } from '../engine';\nimport './display.scss';\n\nconst CELL_SIZE = 5; // px\nconst OFF_COLOR = '#FFFFFF';\nconst ON_COLOR = '#000000';\n\nexport class Display {\n    canvas: HTMLCanvasElement;\n    ctx: CanvasRenderingContext2D;\n\n    memory: WasmMemory;\n    displayPtr: number;\n    registerPtr: number;\n    pixels: Uint8Array;\n\n    width: number;\n    height: number;\n\n    constructor(elementId: string, memory: WasmMemory, displayPtr: number, width: number, height: number) {\n        this.canvas = <HTMLCanvasElement>document.getElementById(elementId);\n        this.ctx = this.canvas.getContext('2d');\n\n        this.memory = memory;\n        this.displayPtr = displayPtr;\n\n        // Give the canvas room for all of the cells and a 1px border\n        // around each of them.\n        this.width = width;\n        this.height = height;\n        this.canvas.height = CELL_SIZE * this.height;\n        this.canvas.width = CELL_SIZE * this.width;\n\n        this.pixels = new Uint8Array(this.memory.buffer, this.displayPtr, this.width * this.height);\n\n        this.drawPixels = this.drawPixels.bind(this);\n    }\n\n    private getIndex(row: number, col: number) {\n        return row * this.width + col;\n    }\n\n    public drawPixels() {\n        this.ctx.beginPath();\n\n        this.ctx.fillStyle = ON_COLOR;\n        for (let row = 0; row < this.height; row++) {\n            for (let col = 0; col < this.width; col++) {\n                const idx = this.getIndex(row, col);\n                if (this.pixels[idx] === 0) { continue; }\n                this.ctx.fillRect(\n                    col * CELL_SIZE,\n                    row * CELL_SIZE,\n                    CELL_SIZE,\n                    CELL_SIZE\n                );\n            }\n        }\n\n        this.ctx.fillStyle = OFF_COLOR;\n        for (let row = 0; row < this.height; row++) {\n            for (let col = 0; col < this.width; col++) {\n                const idx = this.getIndex(row, col);\n                if (this.pixels[idx] === 1) { continue; }\n                this.ctx.fillRect(\n                    col * CELL_SIZE,\n                    row * CELL_SIZE,\n                    CELL_SIZE,\n                    CELL_SIZE\n                );\n            }\n        }\n\n        this.ctx.stroke();\n    }\n}","\nexport class FPS {\n    fps: HTMLElement;\n    frames: Array<number>;\n    lastFrame: number;\n\n    constructor() {\n        this.fps = document.getElementById('fps');\n        this.frames = [];\n        this.lastFrame = performance.now();\n    }\n\n    render() {\n        const now = performance.now();\n        const delta = now - this.lastFrame;\n        this.lastFrame = now;\n        const fps = 1 / delta * 1000;\n\n        // Save only the last 100 timings.\n        this.frames.push(fps);\n        if (this.frames.length > 100) {\n            this.frames.shift();\n        }\n\n        let min = Infinity;\n        let max = -Infinity;\n        let sum = 0;\n        for (let i = 0; i < this.frames.length; i++) {\n            sum += this.frames[i];\n            min = Math.min(this.frames[i], min);\n            max = Math.max(this.frames[i], max);\n        }\n\n        let mean = sum / this.frames.length;\n        this.fps.textContent = `fps: ${Math.round(fps)} (${Math.round(mean)})`;\n    }\n}","import { WasmMemory } from '../engine';\n\nconst MEM_PER_ROW = 32;\n\nexport class MemoryDisplay {\n    memory: WasmMemory;\n    // Pointers to various memory elements.\n    registers: Uint8Array;\n\n    memoryPtr: number;\n    stackPtr: number;\n    pcPtr: number;\n    spPtr: number;\n\n    // Sizes of the register bank, memory bank, and stack.\n    memorySize: number;\n    stackSize: number;\n\n    constructor(\n        memory: WasmMemory,\n        registersPtr: number, numRegisters: number,\n        memoryPtr: number, memorySize: number,\n        stackPtr: number, stackSize: number,\n        pcPtr: number, spPtr: number\n    ) {\n        this.memory = memory;\n\n        this.registers = new Uint8Array(this.memory.buffer, registersPtr, numRegisters);\n\n        this.memoryPtr = memoryPtr;\n        this.memorySize = memorySize;\n\n        this.stackPtr = stackPtr;\n        this.stackSize = stackSize;\n\n        this.pcPtr = pcPtr;\n        this.spPtr = spPtr;\n\n        this._toHex = this._toHex.bind(this);\n        this.drawMemory = this.drawMemory.bind(this);\n        this.drawRegisters = this.drawRegisters.bind(this);\n    }\n\n    private _toHex(number: number, len: number = 2) {\n        const hex = number.toString(16);\n        return '0'.repeat(len - hex.length) + hex;\n    }\n\n    public drawRegisters() {\n        let disp = '';\n        for (let idx = 0; idx < this.registers.length - 2; idx++) {\n            disp += `<div>V${this._toHex(idx)}: 0x${this._toHex(this.registers[idx])}</div>`;\n        }\n\n        document.getElementById('registers').innerHTML = disp;\n    }\n\n    public drawMemory(isPaused: boolean) {\n        const element = document.getElementById('memory');\n        if (!isPaused) {\n            element.innerHTML = '<code>Memory only shown on pause.</code>';\n            return;\n        }\n\n        const memory = new Uint8Array(this.memory.buffer, this.memoryPtr, this.memorySize);\n\n        let disp = '';\n\n        for (let row = 0; row < (this.memorySize / MEM_PER_ROW); row++) {\n            let rowStart = row * MEM_PER_ROW;\n            disp += `<div>${this._toHex(rowStart, 3)}: `;\n            for (let col = 0; col < MEM_PER_ROW; col++) {\n                let idx = (row * MEM_PER_ROW) + col;\n                disp += `<span>${this._toHex(memory[idx])}</span>`\n            }\n            disp += '</div>';\n        }\n\n        element.innerHTML = `<code>${disp}</code>`;\n    }\n}\n","import { CHIP8, Key } from 'z80-emulator';\n\nimport { Display } from './ui/display';\nimport { FPS } from './ui/fps';\nimport { MemoryDisplay } from './ui/memory';\n\nexport interface WasmMemory {\n    buffer: ArrayBuffer;\n}\n\nconst SPEED_UP = 4;\n// Maps keycode -> CHIP-8 key.\nconst KEY_MAP: { [key: number]: Key } = {\n    49: 0x1,  // 1\n    50: 0x2,  // 2\n    51: 0x3,  // 3\n    52: 0xC,  // 4\n    81: 0x4,  // Q\n    87: 0x5,  // W\n    69: 0x6,  // E\n    82: 0xD,  // R\n    65: 0x7,  // A\n    83: 0x8,  // S\n    68: 0x9,  // D\n    70: 0xE,  // F\n    90: 0xA,  // Z\n    88: 0x0,  // X\n    67: 0xB,  // C\n    86: 0xF   // V\n};\n\nexport default class Engine {\n    public animationId: number = null;\n\n    engine: CHIP8 = CHIP8.new();\n    memory: WasmMemory;\n\n    width: number = CHIP8.display_width();\n    height: number = CHIP8.display_height();\n\n    fps: FPS;\n    display: Display;\n    memDisplay: MemoryDisplay;\n\n    showMemDisplay: boolean;\n\n    constructor(memory: WasmMemory) {\n        this.memory = memory;\n        this.display = new Display(\n            'engine-display',\n            this.memory,\n            this.engine.display(),\n            this.width,\n            this.height\n        );\n\n        this.memDisplay = new MemoryDisplay(\n            this.memory,\n            this.engine.registers(),\n            CHIP8.num_registers(),\n            this.engine.memory(),\n            CHIP8.mem_size(),\n            this.engine.stack(),\n            CHIP8.stack_size(),\n            this.engine.pc(),\n            this.engine.sp()\n        );\n        this.fps = new FPS();\n\n        this.handleKeyPress = this.handleKeyPress.bind(this);\n        this.handleKeyUp = this.handleKeyUp.bind(this);\n        this.isPaused = this.isPaused.bind(this);\n        this.render = this.render.bind(this);\n        this.tick = this.tick.bind(this);\n\n        window.addEventListener('keydown', this.handleKeyPress);\n        window.addEventListener('keyup', this.handleKeyUp);\n    }\n\n    private _Base64toBytes(data: string) {\n        let decoded = atob(data);\n        let array = new Uint8Array(decoded.length);\n        for (let i = 0; i < decoded.length; i++) {\n            array[i] = decoded.charCodeAt(i);\n        }\n\n        return array;\n    }\n\n    private _parseURLParams() {\n        let urlParams = new URLSearchParams(window.location.search);\n        this.showMemDisplay = urlParams.has('memDisplay') ? urlParams.get('memDisplay') === 'true' : false;\n    }\n\n    public handleKeyPress(ev: KeyboardEvent) {\n        if (ev.keyCode in KEY_MAP) {\n            this.engine.key_press(KEY_MAP[ev.keyCode]);\n        }\n    }\n\n    public handleKeyUp(ev: KeyboardEvent) {\n        if (ev.keyCode in KEY_MAP) {\n            this.engine.key_up(KEY_MAP[ev.keyCode]);\n        }\n    }\n\n    public isPaused() {\n        return this.animationId === null;\n    }\n\n    public tick() {\n        this.fps.render();\n\n        this.render();\n        for (let i = 0; i < SPEED_UP; i++) {\n            this.engine.tick();\n        }\n        this.animationId = requestAnimationFrame(this.tick);\n    }\n\n    public render() {\n        this.display.drawPixels();\n\n        this.memDisplay.drawRegisters();\n        if (this.showMemDisplay) {\n            this.memDisplay.drawMemory(this.isPaused());\n        }\n    }\n}","// I couldn't quite figure out how to do this import correctly in Typescript,\n// so for now we have a normal javascript bootstrap piece which loads the\n// main application written in Typescript.\nimport { memory } from 'z80-emulator/z80_emulator_bg';\nimport Engine from './lib/engine';\nconst ROM_LIST = [\n  { path: 'Breakout [Carmelo Cortez, 1979].ch8', name: 'Breakout' },\n  { path: 'Brix [Andreas Gustafsson, 1990].ch8', name: 'Brix' },\n  { path: 'Chip8 emulator Logo [Garstyciuks].ch8', name: 'Chip8 Logo' },\n  { path: 'Maze [David Winter, 199x].ch8', name: 'Maze' },\n  { path: 'Particle Demo [zeroZshadow, 2008].ch8', name: 'Particle Demo' },\n  { path: 'Pong (alt).ch8', name: 'Pong' },\n  { path: 'Sierpinski [Sergey Naydenov, 2010].ch8', name: 'Sierpinski' },\n  { path: 'Space Invaders [David Winter].ch8', name: 'Space Invaders' },\n  { path: 'Tetris [Fran Dachille, 1991].ch8', name: 'Tetris' },\n  { path: 'Zero Demo [zeroZshadow, 2007].ch8', name: 'Zero Demo' },\n];\n\nlet engine = new Engine(memory);\n\n// Handle ROM loading\nconst romList = document.getElementById('rom-list');\nromList.innerHTML += '<option>Select a ROM</option>';\nROM_LIST.forEach(rom => romList.innerHTML += `<option value=\"${rom.path}\">${rom.name}</option>`);\nromList.addEventListener('change', event => {\n  const rom = event.target.value;\n  return fetch(`roms/chip8/${rom}`)\n    .then((resp) => {\n      if (!resp.ok) {\n        throw new Error(resp.statusText);\n      }\n\n      return resp.arrayBuffer();\n    })\n    .then((buffer) => {\n      let array = new Uint8Array(buffer);\n      engine.engine.load_rom(array);\n    });\n});\n\n\nconst playPauseButton = document.getElementById('play-pause');\nplayPauseButton.textContent = '▶';\n\nconst play = () => {\n  playPauseButton.textContent = \"⏸\";\n  engine.tick();\n};\n\nconst pause = () => {\n  playPauseButton.textContent = '▶';\n  cancelAnimationFrame(engine.animationId);\n  engine.animationId = null;\n};\n\nplayPauseButton.addEventListener('click', event => {\n  if (engine.isPaused()) {\n    console.log('Starting engine');\n    play();\n  } else {\n    console.log('Pausing engine');\n    pause();\n    engine.render();\n  }\n});\n\n// Render UI but don't start engine yet.\nengine.render();","/* tslint:disable */\nimport * as wasm from './z80_emulator_bg';\n\nconst __wbg_log_c91f5c35c829c418_target = console.log;\n\nlet cachedDecoder = new TextDecoder('utf-8');\n\nlet cachegetUint8Memory = null;\nfunction getUint8Memory() {\n    if (cachegetUint8Memory === null || cachegetUint8Memory.buffer !== wasm.memory.buffer) {\n        cachegetUint8Memory = new Uint8Array(wasm.memory.buffer);\n    }\n    return cachegetUint8Memory;\n}\n\nfunction getStringFromWasm(ptr, len) {\n    return cachedDecoder.decode(getUint8Memory().subarray(ptr, ptr + len));\n}\n\nexport function __wbg_log_c91f5c35c829c418(arg0, arg1) {\n    let varg0 = getStringFromWasm(arg0, arg1);\n    __wbg_log_c91f5c35c829c418_target(varg0);\n}\n/**\n*/\nexport const Key = Object.freeze({ K1:0,K2:1,K3:2,K4:3,K5:4,K6:5,K7:6,K8:7,K9:8,K0:9,KA:10,KB:11,KC:12,KD:13,KE:14,KF:15, });\n/**\n*/\nexport const Register = Object.freeze({ V0:0,V1:1,V2:2,V3:3,V4:4,V5:5,V6:6,V7:7,V8:8,V9:9,VA:10,VB:11,VC:12,VD:13,VE:14,VF:15,DT:16,ST:17, });\n\nfunction passArray8ToWasm(arg) {\n    const ptr = wasm.__wbindgen_malloc(arg.length * 1);\n    getUint8Memory().set(arg, ptr / 1);\n    return [ptr, arg.length];\n}\n\nfunction isLikeNone(x) {\n    return x === undefined || x === null;\n}\n\nconst __wbg_random_86efc8986c8a8805_target = Math.random.bind(Math) || function() {\n    throw new Error(`wasm-bindgen: Math.random.bind(Math) does not exist`);\n};\n\nexport function __wbg_random_86efc8986c8a8805() {\n    return __wbg_random_86efc8986c8a8805_target();\n}\n\nfunction freeCHIP8(ptr) {\n\n    wasm.__wbg_chip8_free(ptr);\n}\n/**\n*/\nexport class CHIP8 {\n\n    static __construct(ptr) {\n        return new CHIP8(ptr);\n    }\n\n    constructor(ptr) {\n        this.ptr = ptr;\n\n    }\n\n    free() {\n        const ptr = this.ptr;\n        this.ptr = 0;\n        freeCHIP8(ptr);\n    }\n    /**\n    * @returns {CHIP8}\n    */\n    static new() {\n        return CHIP8.__construct(wasm.chip8_new());\n    }\n    /**\n    * @returns {number}\n    */\n    static display_height() {\n        return wasm.chip8_display_height();\n    }\n    /**\n    * @returns {number}\n    */\n    static display_width() {\n        return wasm.chip8_display_width();\n    }\n    /**\n    * @returns {number}\n    */\n    static mem_size() {\n        return wasm.chip8_mem_size();\n    }\n    /**\n    * @returns {number}\n    */\n    static num_registers() {\n        return wasm.chip8_num_registers();\n    }\n    /**\n    * @returns {number}\n    */\n    static stack_size() {\n        return wasm.chip8_stack_size();\n    }\n    /**\n    * @returns {number}\n    */\n    display() {\n        if (this.ptr === 0) {\n            throw new Error('Attempt to use a moved value');\n        }\n        return wasm.chip8_display(this.ptr);\n    }\n    /**\n    * @returns {number}\n    */\n    registers() {\n        if (this.ptr === 0) {\n            throw new Error('Attempt to use a moved value');\n        }\n        return wasm.chip8_registers(this.ptr);\n    }\n    /**\n    * @returns {number}\n    */\n    memory() {\n        if (this.ptr === 0) {\n            throw new Error('Attempt to use a moved value');\n        }\n        return wasm.chip8_memory(this.ptr);\n    }\n    /**\n    * @returns {number}\n    */\n    stack() {\n        if (this.ptr === 0) {\n            throw new Error('Attempt to use a moved value');\n        }\n        return wasm.chip8_stack(this.ptr);\n    }\n    /**\n    * @returns {number}\n    */\n    pc() {\n        if (this.ptr === 0) {\n            throw new Error('Attempt to use a moved value');\n        }\n        return wasm.chip8_pc(this.ptr);\n    }\n    /**\n    * @returns {number}\n    */\n    sp() {\n        if (this.ptr === 0) {\n            throw new Error('Attempt to use a moved value');\n        }\n        return wasm.chip8_sp(this.ptr);\n    }\n    /**\n    * @param {number} arg0\n    * @returns {void}\n    */\n    key_press(arg0) {\n        if (this.ptr === 0) {\n            throw new Error('Attempt to use a moved value');\n        }\n        return wasm.chip8_key_press(this.ptr, arg0);\n    }\n    /**\n    * @param {number} arg0\n    * @returns {void}\n    */\n    key_up(arg0) {\n        if (this.ptr === 0) {\n            throw new Error('Attempt to use a moved value');\n        }\n        return wasm.chip8_key_up(this.ptr, arg0);\n    }\n    /**\n    * @param {Uint8Array} arg0\n    * @returns {number}\n    */\n    load_rom(arg0) {\n        if (this.ptr === 0) {\n            throw new Error('Attempt to use a moved value');\n        }\n        const [ptr0, len0] = isLikeNone(arg0) ? [0, 0] : passArray8ToWasm(arg0);\n        return wasm.chip8_load_rom(this.ptr, ptr0, len0);\n    }\n    /**\n    * @returns {void}\n    */\n    reset() {\n        if (this.ptr === 0) {\n            throw new Error('Attempt to use a moved value');\n        }\n        return wasm.chip8_reset(this.ptr);\n    }\n    /**\n    * @returns {void}\n    */\n    tick() {\n        if (this.ptr === 0) {\n            throw new Error('Attempt to use a moved value');\n        }\n        return wasm.chip8_tick(this.ptr);\n    }\n}\n\nexport function __wbindgen_throw(ptr, len) {\n    throw new Error(getStringFromWasm(ptr, len));\n}\n\n","exports = module.exports = require(\"../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \"body {\\n  position: absolute;\\n  top: 0;\\n  left: 0;\\n  width: 100%;\\n  height: 100%;\\n  display: flex;\\n  flex-direction: row;\\n  align-items: top;\\n  justify-content: center; }\\n\\ncode {\\n  font-size: 10px; }\\n\\ntable td {\\n  padding: 0 16px;\\n  text-align: center; }\\n  table td .sidebar {\\n    width: 100px; }\\n  table td .topbar {\\n    width: 100%;\\n    text-align: center; }\\n\\ncanvas {\\n  border: 1px solid #EEE; }\\n\\n#memory {\\n  height: 512px;\\n  overflow-y: scroll; }\\n\\n#memory div > span {\\n  margin-right: 4px; }\\n\", \"\"]);\n\n// exports\n","\nvar content = require(\"!!../../../node_modules/css-loader/index.js!../../../node_modules/sass-loader/lib/loader.js!./display.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../node_modules/css-loader/index.js!../../../node_modules/sass-loader/lib/loader.js!./display.scss\", function() {\n\t\tvar newContent = require(\"!!../../../node_modules/css-loader/index.js!../../../node_modules/sass-loader/lib/loader.js!./display.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n// css base code, injected by the css-loader\nmodule.exports = function(useSourceMap) {\n\tvar list = [];\n\n\t// return the list of modules as css string\n\tlist.toString = function toString() {\n\t\treturn this.map(function (item) {\n\t\t\tvar content = cssWithMappingToString(item, useSourceMap);\n\t\t\tif(item[2]) {\n\t\t\t\treturn \"@media \" + item[2] + \"{\" + content + \"}\";\n\t\t\t} else {\n\t\t\t\treturn content;\n\t\t\t}\n\t\t}).join(\"\");\n\t};\n\n\t// import a list of modules into the list\n\tlist.i = function(modules, mediaQuery) {\n\t\tif(typeof modules === \"string\")\n\t\t\tmodules = [[null, modules, \"\"]];\n\t\tvar alreadyImportedModules = {};\n\t\tfor(var i = 0; i < this.length; i++) {\n\t\t\tvar id = this[i][0];\n\t\t\tif(typeof id === \"number\")\n\t\t\t\talreadyImportedModules[id] = true;\n\t\t}\n\t\tfor(i = 0; i < modules.length; i++) {\n\t\t\tvar item = modules[i];\n\t\t\t// skip already imported module\n\t\t\t// this implementation is not 100% perfect for weird media query combinations\n\t\t\t//  when a module is imported multiple times with different media queries.\n\t\t\t//  I hope this will never occur (Hey this way we have smaller bundles)\n\t\t\tif(typeof item[0] !== \"number\" || !alreadyImportedModules[item[0]]) {\n\t\t\t\tif(mediaQuery && !item[2]) {\n\t\t\t\t\titem[2] = mediaQuery;\n\t\t\t\t} else if(mediaQuery) {\n\t\t\t\t\titem[2] = \"(\" + item[2] + \") and (\" + mediaQuery + \")\";\n\t\t\t\t}\n\t\t\t\tlist.push(item);\n\t\t\t}\n\t\t}\n\t};\n\treturn list;\n};\n\nfunction cssWithMappingToString(item, useSourceMap) {\n\tvar content = item[1] || '';\n\tvar cssMapping = item[3];\n\tif (!cssMapping) {\n\t\treturn content;\n\t}\n\n\tif (useSourceMap && typeof btoa === 'function') {\n\t\tvar sourceMapping = toComment(cssMapping);\n\t\tvar sourceURLs = cssMapping.sources.map(function (source) {\n\t\t\treturn '/*# sourceURL=' + cssMapping.sourceRoot + source + ' */'\n\t\t});\n\n\t\treturn [content].concat(sourceURLs).concat([sourceMapping]).join('\\n');\n\t}\n\n\treturn [content].join('\\n');\n}\n\n// Adapted from convert-source-map (MIT)\nfunction toComment(sourceMap) {\n\t// eslint-disable-next-line no-undef\n\tvar base64 = btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));\n\tvar data = 'sourceMappingURL=data:application/json;charset=utf-8;base64,' + base64;\n\n\treturn '/*# ' + data + ' */';\n}\n","/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\nvar stylesInDom = {};\n\nvar\tmemoize = function (fn) {\n\tvar memo;\n\n\treturn function () {\n\t\tif (typeof memo === \"undefined\") memo = fn.apply(this, arguments);\n\t\treturn memo;\n\t};\n};\n\nvar isOldIE = memoize(function () {\n\t// Test for IE <= 9 as proposed by Browserhacks\n\t// @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n\t// Tests for existence of standard globals is to allow style-loader\n\t// to operate correctly into non-standard environments\n\t// @see https://github.com/webpack-contrib/style-loader/issues/177\n\treturn window && document && document.all && !window.atob;\n});\n\nvar getTarget = function (target, parent) {\n  if (parent){\n    return parent.querySelector(target);\n  }\n  return document.querySelector(target);\n};\n\nvar getElement = (function (fn) {\n\tvar memo = {};\n\n\treturn function(target, parent) {\n                // If passing function in options, then use it for resolve \"head\" element.\n                // Useful for Shadow Root style i.e\n                // {\n                //   insertInto: function () { return document.querySelector(\"#foo\").shadowRoot }\n                // }\n                if (typeof target === 'function') {\n                        return target();\n                }\n                if (typeof memo[target] === \"undefined\") {\n\t\t\tvar styleTarget = getTarget.call(this, target, parent);\n\t\t\t// Special case to return head of iframe instead of iframe itself\n\t\t\tif (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {\n\t\t\t\ttry {\n\t\t\t\t\t// This will throw an exception if access to iframe is blocked\n\t\t\t\t\t// due to cross-origin restrictions\n\t\t\t\t\tstyleTarget = styleTarget.contentDocument.head;\n\t\t\t\t} catch(e) {\n\t\t\t\t\tstyleTarget = null;\n\t\t\t\t}\n\t\t\t}\n\t\t\tmemo[target] = styleTarget;\n\t\t}\n\t\treturn memo[target]\n\t};\n})();\n\nvar singleton = null;\nvar\tsingletonCounter = 0;\nvar\tstylesInsertedAtTop = [];\n\nvar\tfixUrls = require(\"./urls\");\n\nmodule.exports = function(list, options) {\n\tif (typeof DEBUG !== \"undefined\" && DEBUG) {\n\t\tif (typeof document !== \"object\") throw new Error(\"The style-loader cannot be used in a non-browser environment\");\n\t}\n\n\toptions = options || {};\n\n\toptions.attrs = typeof options.attrs === \"object\" ? options.attrs : {};\n\n\t// Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n\t// tags it will allow on a page\n\tif (!options.singleton && typeof options.singleton !== \"boolean\") options.singleton = isOldIE();\n\n\t// By default, add <style> tags to the <head> element\n        if (!options.insertInto) options.insertInto = \"head\";\n\n\t// By default, add <style> tags to the bottom of the target\n\tif (!options.insertAt) options.insertAt = \"bottom\";\n\n\tvar styles = listToStyles(list, options);\n\n\taddStylesToDom(styles, options);\n\n\treturn function update (newList) {\n\t\tvar mayRemove = [];\n\n\t\tfor (var i = 0; i < styles.length; i++) {\n\t\t\tvar item = styles[i];\n\t\t\tvar domStyle = stylesInDom[item.id];\n\n\t\t\tdomStyle.refs--;\n\t\t\tmayRemove.push(domStyle);\n\t\t}\n\n\t\tif(newList) {\n\t\t\tvar newStyles = listToStyles(newList, options);\n\t\t\taddStylesToDom(newStyles, options);\n\t\t}\n\n\t\tfor (var i = 0; i < mayRemove.length; i++) {\n\t\t\tvar domStyle = mayRemove[i];\n\n\t\t\tif(domStyle.refs === 0) {\n\t\t\t\tfor (var j = 0; j < domStyle.parts.length; j++) domStyle.parts[j]();\n\n\t\t\t\tdelete stylesInDom[domStyle.id];\n\t\t\t}\n\t\t}\n\t};\n};\n\nfunction addStylesToDom (styles, options) {\n\tfor (var i = 0; i < styles.length; i++) {\n\t\tvar item = styles[i];\n\t\tvar domStyle = stylesInDom[item.id];\n\n\t\tif(domStyle) {\n\t\t\tdomStyle.refs++;\n\n\t\t\tfor(var j = 0; j < domStyle.parts.length; j++) {\n\t\t\t\tdomStyle.parts[j](item.parts[j]);\n\t\t\t}\n\n\t\t\tfor(; j < item.parts.length; j++) {\n\t\t\t\tdomStyle.parts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\t\t} else {\n\t\t\tvar parts = [];\n\n\t\t\tfor(var j = 0; j < item.parts.length; j++) {\n\t\t\t\tparts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\n\t\t\tstylesInDom[item.id] = {id: item.id, refs: 1, parts: parts};\n\t\t}\n\t}\n}\n\nfunction listToStyles (list, options) {\n\tvar styles = [];\n\tvar newStyles = {};\n\n\tfor (var i = 0; i < list.length; i++) {\n\t\tvar item = list[i];\n\t\tvar id = options.base ? item[0] + options.base : item[0];\n\t\tvar css = item[1];\n\t\tvar media = item[2];\n\t\tvar sourceMap = item[3];\n\t\tvar part = {css: css, media: media, sourceMap: sourceMap};\n\n\t\tif(!newStyles[id]) styles.push(newStyles[id] = {id: id, parts: [part]});\n\t\telse newStyles[id].parts.push(part);\n\t}\n\n\treturn styles;\n}\n\nfunction insertStyleElement (options, style) {\n\tvar target = getElement(options.insertInto)\n\n\tif (!target) {\n\t\tthrow new Error(\"Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.\");\n\t}\n\n\tvar lastStyleElementInsertedAtTop = stylesInsertedAtTop[stylesInsertedAtTop.length - 1];\n\n\tif (options.insertAt === \"top\") {\n\t\tif (!lastStyleElementInsertedAtTop) {\n\t\t\ttarget.insertBefore(style, target.firstChild);\n\t\t} else if (lastStyleElementInsertedAtTop.nextSibling) {\n\t\t\ttarget.insertBefore(style, lastStyleElementInsertedAtTop.nextSibling);\n\t\t} else {\n\t\t\ttarget.appendChild(style);\n\t\t}\n\t\tstylesInsertedAtTop.push(style);\n\t} else if (options.insertAt === \"bottom\") {\n\t\ttarget.appendChild(style);\n\t} else if (typeof options.insertAt === \"object\" && options.insertAt.before) {\n\t\tvar nextSibling = getElement(options.insertAt.before, target);\n\t\ttarget.insertBefore(style, nextSibling);\n\t} else {\n\t\tthrow new Error(\"[Style Loader]\\n\\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\\n Must be 'top', 'bottom', or Object.\\n (https://github.com/webpack-contrib/style-loader#insertat)\\n\");\n\t}\n}\n\nfunction removeStyleElement (style) {\n\tif (style.parentNode === null) return false;\n\tstyle.parentNode.removeChild(style);\n\n\tvar idx = stylesInsertedAtTop.indexOf(style);\n\tif(idx >= 0) {\n\t\tstylesInsertedAtTop.splice(idx, 1);\n\t}\n}\n\nfunction createStyleElement (options) {\n\tvar style = document.createElement(\"style\");\n\n\tif(options.attrs.type === undefined) {\n\t\toptions.attrs.type = \"text/css\";\n\t}\n\n\tif(options.attrs.nonce === undefined) {\n\t\tvar nonce = getNonce();\n\t\tif (nonce) {\n\t\t\toptions.attrs.nonce = nonce;\n\t\t}\n\t}\n\n\taddAttrs(style, options.attrs);\n\tinsertStyleElement(options, style);\n\n\treturn style;\n}\n\nfunction createLinkElement (options) {\n\tvar link = document.createElement(\"link\");\n\n\tif(options.attrs.type === undefined) {\n\t\toptions.attrs.type = \"text/css\";\n\t}\n\toptions.attrs.rel = \"stylesheet\";\n\n\taddAttrs(link, options.attrs);\n\tinsertStyleElement(options, link);\n\n\treturn link;\n}\n\nfunction addAttrs (el, attrs) {\n\tObject.keys(attrs).forEach(function (key) {\n\t\tel.setAttribute(key, attrs[key]);\n\t});\n}\n\nfunction getNonce() {\n\tif (typeof __webpack_nonce__ === 'undefined') {\n\t\treturn null;\n\t}\n\n\treturn __webpack_nonce__;\n}\n\nfunction addStyle (obj, options) {\n\tvar style, update, remove, result;\n\n\t// If a transform function was defined, run it on the css\n\tif (options.transform && obj.css) {\n\t    result = typeof options.transform === 'function'\n\t\t ? options.transform(obj.css) \n\t\t : options.transform.default(obj.css);\n\n\t    if (result) {\n\t    \t// If transform returns a value, use that instead of the original css.\n\t    \t// This allows running runtime transformations on the css.\n\t    \tobj.css = result;\n\t    } else {\n\t    \t// If the transform function returns a falsy value, don't add this css.\n\t    \t// This allows conditional loading of css\n\t    \treturn function() {\n\t    \t\t// noop\n\t    \t};\n\t    }\n\t}\n\n\tif (options.singleton) {\n\t\tvar styleIndex = singletonCounter++;\n\n\t\tstyle = singleton || (singleton = createStyleElement(options));\n\n\t\tupdate = applyToSingletonTag.bind(null, style, styleIndex, false);\n\t\tremove = applyToSingletonTag.bind(null, style, styleIndex, true);\n\n\t} else if (\n\t\tobj.sourceMap &&\n\t\ttypeof URL === \"function\" &&\n\t\ttypeof URL.createObjectURL === \"function\" &&\n\t\ttypeof URL.revokeObjectURL === \"function\" &&\n\t\ttypeof Blob === \"function\" &&\n\t\ttypeof btoa === \"function\"\n\t) {\n\t\tstyle = createLinkElement(options);\n\t\tupdate = updateLink.bind(null, style, options);\n\t\tremove = function () {\n\t\t\tremoveStyleElement(style);\n\n\t\t\tif(style.href) URL.revokeObjectURL(style.href);\n\t\t};\n\t} else {\n\t\tstyle = createStyleElement(options);\n\t\tupdate = applyToTag.bind(null, style);\n\t\tremove = function () {\n\t\t\tremoveStyleElement(style);\n\t\t};\n\t}\n\n\tupdate(obj);\n\n\treturn function updateStyle (newObj) {\n\t\tif (newObj) {\n\t\t\tif (\n\t\t\t\tnewObj.css === obj.css &&\n\t\t\t\tnewObj.media === obj.media &&\n\t\t\t\tnewObj.sourceMap === obj.sourceMap\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tupdate(obj = newObj);\n\t\t} else {\n\t\t\tremove();\n\t\t}\n\t};\n}\n\nvar replaceText = (function () {\n\tvar textStore = [];\n\n\treturn function (index, replacement) {\n\t\ttextStore[index] = replacement;\n\n\t\treturn textStore.filter(Boolean).join('\\n');\n\t};\n})();\n\nfunction applyToSingletonTag (style, index, remove, obj) {\n\tvar css = remove ? \"\" : obj.css;\n\n\tif (style.styleSheet) {\n\t\tstyle.styleSheet.cssText = replaceText(index, css);\n\t} else {\n\t\tvar cssNode = document.createTextNode(css);\n\t\tvar childNodes = style.childNodes;\n\n\t\tif (childNodes[index]) style.removeChild(childNodes[index]);\n\n\t\tif (childNodes.length) {\n\t\t\tstyle.insertBefore(cssNode, childNodes[index]);\n\t\t} else {\n\t\t\tstyle.appendChild(cssNode);\n\t\t}\n\t}\n}\n\nfunction applyToTag (style, obj) {\n\tvar css = obj.css;\n\tvar media = obj.media;\n\n\tif(media) {\n\t\tstyle.setAttribute(\"media\", media)\n\t}\n\n\tif(style.styleSheet) {\n\t\tstyle.styleSheet.cssText = css;\n\t} else {\n\t\twhile(style.firstChild) {\n\t\t\tstyle.removeChild(style.firstChild);\n\t\t}\n\n\t\tstyle.appendChild(document.createTextNode(css));\n\t}\n}\n\nfunction updateLink (link, options, obj) {\n\tvar css = obj.css;\n\tvar sourceMap = obj.sourceMap;\n\n\t/*\n\t\tIf convertToAbsoluteUrls isn't defined, but sourcemaps are enabled\n\t\tand there is no publicPath defined then lets turn convertToAbsoluteUrls\n\t\ton by default.  Otherwise default to the convertToAbsoluteUrls option\n\t\tdirectly\n\t*/\n\tvar autoFixUrls = options.convertToAbsoluteUrls === undefined && sourceMap;\n\n\tif (options.convertToAbsoluteUrls || autoFixUrls) {\n\t\tcss = fixUrls(css);\n\t}\n\n\tif (sourceMap) {\n\t\t// http://stackoverflow.com/a/26603875\n\t\tcss += \"\\n/*# sourceMappingURL=data:application/json;base64,\" + btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))) + \" */\";\n\t}\n\n\tvar blob = new Blob([css], { type: \"text/css\" });\n\n\tvar oldSrc = link.href;\n\n\tlink.href = URL.createObjectURL(blob);\n\n\tif(oldSrc) URL.revokeObjectURL(oldSrc);\n}\n","\n/**\n * When source maps are enabled, `style-loader` uses a link element with a data-uri to\n * embed the css on the page. This breaks all relative urls because now they are relative to a\n * bundle instead of the current page.\n *\n * One solution is to only use full urls, but that may be impossible.\n *\n * Instead, this function \"fixes\" the relative urls to be absolute according to the current page location.\n *\n * A rudimentary test suite is located at `test/fixUrls.js` and can be run via the `npm test` command.\n *\n */\n\nmodule.exports = function (css) {\n  // get current location\n  var location = typeof window !== \"undefined\" && window.location;\n\n  if (!location) {\n    throw new Error(\"fixUrls requires window.location\");\n  }\n\n\t// blank or null?\n\tif (!css || typeof css !== \"string\") {\n\t  return css;\n  }\n\n  var baseUrl = location.protocol + \"//\" + location.host;\n  var currentDir = baseUrl + location.pathname.replace(/\\/[^\\/]*$/, \"/\");\n\n\t// convert each url(...)\n\t/*\n\tThis regular expression is just a way to recursively match brackets within\n\ta string.\n\n\t /url\\s*\\(  = Match on the word \"url\" with any whitespace after it and then a parens\n\t   (  = Start a capturing group\n\t     (?:  = Start a non-capturing group\n\t         [^)(]  = Match anything that isn't a parentheses\n\t         |  = OR\n\t         \\(  = Match a start parentheses\n\t             (?:  = Start another non-capturing groups\n\t                 [^)(]+  = Match anything that isn't a parentheses\n\t                 |  = OR\n\t                 \\(  = Match a start parentheses\n\t                     [^)(]*  = Match anything that isn't a parentheses\n\t                 \\)  = Match a end parentheses\n\t             )  = End Group\n              *\\) = Match anything and then a close parens\n          )  = Close non-capturing group\n          *  = Match anything\n       )  = Close capturing group\n\t \\)  = Match a close parens\n\n\t /gi  = Get all matches, not the first.  Be case insensitive.\n\t */\n\tvar fixedCss = css.replace(/url\\s*\\(((?:[^)(]|\\((?:[^)(]+|\\([^)(]*\\))*\\))*)\\)/gi, function(fullMatch, origUrl) {\n\t\t// strip quotes (if they exist)\n\t\tvar unquotedOrigUrl = origUrl\n\t\t\t.trim()\n\t\t\t.replace(/^\"(.*)\"$/, function(o, $1){ return $1; })\n\t\t\t.replace(/^'(.*)'$/, function(o, $1){ return $1; });\n\n\t\t// already a full url? no change\n\t\tif (/^(#|data:|http:\\/\\/|https:\\/\\/|file:\\/\\/\\/|\\s*$)/i.test(unquotedOrigUrl)) {\n\t\t  return fullMatch;\n\t\t}\n\n\t\t// convert the url to a full url\n\t\tvar newUrl;\n\n\t\tif (unquotedOrigUrl.indexOf(\"//\") === 0) {\n\t\t  \t//TODO: should we add protocol?\n\t\t\tnewUrl = unquotedOrigUrl;\n\t\t} else if (unquotedOrigUrl.indexOf(\"/\") === 0) {\n\t\t\t// path should be relative to the base url\n\t\t\tnewUrl = baseUrl + unquotedOrigUrl; // already starts with '/'\n\t\t} else {\n\t\t\t// path should be relative to current directory\n\t\t\tnewUrl = currentDir + unquotedOrigUrl.replace(/^\\.\\//, \"\"); // Strip leading './'\n\t\t}\n\n\t\t// send back the fixed url(...)\n\t\treturn \"url(\" + JSON.stringify(newUrl) + \")\";\n\t});\n\n\t// send back the fixed css\n\treturn fixedCss;\n};\n"],"sourceRoot":""}